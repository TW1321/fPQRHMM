---
title: "fPQRHMM"
author: "Thomas Whitehead"
date: "12/13/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This package `fPQRHMM` performs dimension reduction for Quantile Regression by using a combination of the `fPQR` algorithm developed by Civieta et al. in 2021, and the `HMM` algorithm developed by Bar et al. in 2021. Source code comes from the `QREM` and `SEMMS` packages written by Haim Bar and the `fPQR` package written by Álvaro Méndez Civieta

```{r}
library(fPQRHMM)
```

### fPQR_fit
The fPQR_fit function takes as inputs the covariate matrix $X_0$, response matrix $Y_0$, and quantile $q$. It then decomposes $X_0$ into a score matrix $T$ that has maximal quantile covariance with $Y_0$. Then, using an HMM algorithm, you perform variable selection for quantile regression of $Y$ on $T$. Finally, you fit the chosen model for quantile regression of $Y$ on $T$, and convert the coefficients into coefficients for X_0 $\hat{\beta}_q$. The output is a list that includes $\hat{\beta}_q$, the fitted model of $Y$ on $T$, and the run times for decomposition of Y into T, variable selection, model fitting, and coefficient transformation. An example with randomly generated $X_0$ and $Y_0$ is given below.
```{r}
library(MASS)
X_0=mvrnorm(100, mu=rep(0,100), Sigma=diag(100))
beta=rep(1,100)
Y= X_0%&%beta + rnorm(100)
mod=fPQR_fit(X_0,Y_0,0.5)
matplot(1:100, cbind(mod,beta))
```
